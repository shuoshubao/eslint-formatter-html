<!DOCTYPE html>
<html>
    <head>
        <title>ESLint Report</title>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <link rel="stylesheet" href="https://static.meituan.net/bs/@ss/mtd-vue/0.3.5/lib/theme2/index.css" />
        <link rel="stylesheet" href="../lib/style.css" />
    </head>

    <body>

            <div id="vue-app-root" style="display: none;">
        <mtd-card class="eslint-analysis" title="EslintÁªüËÆ°">
            <mtd-row style="padding-bottom: 10px;" v-if="analysis.errorCount + analysis.warningCount">
                <mtd-col :span="4" v-for="(item, index) in analysisList" :key="index">
                    <span class="label">{{ item.label }}:</span>
                    <span class="value" v-html="analysis[item.prop]"></span>
                </mtd-col>
            </mtd-row>
            <mtd-row v-else>
                <mtd-progress type="circle" :percentage="100" status="success"></mtd-progress>
            </mtd-row>
            <mtd-row v-if="!!RankMessages.length">
                <mtd-col>
                    <mtd-table :data="RankMessages" style="width: 100%;" size="small" border>
                        <mtd-table-column label="rank" width="60">
                            <template slot-scope="scope">
                                <span :class="{ 'color-danger': scope.$index < 5 }">{{ scope.$index + 1 }}</span>
                            </template>
                        </mtd-table-column>
                        <mtd-table-column label="count" prop="count" width="70"></mtd-table-column>
                        <mtd-table-column label="severity" prop="severityText" width="80"></mtd-table-column>
                        <mtd-table-column label="ruleId" width="300">
                            <template slot-scope="scope" v-if="scope.row.ruleId">
                                <a :href="scope.row.url" target="_blank">
                                    <mtd-button size="small" type="text-primary">{{ scope.row.ruleId }}</mtd-button>
                                </a>
                                <span v-if="scope.row.fixable" style="font-size: 12px;">üîß</span>
                            </template>
                        </mtd-table-column>
                        <mtd-table-column label="description" prop="description"></mtd-table-column>
                    </mtd-table>
                </mtd-col>
            </mtd-row>
        </mtd-card>
        <mtd-card class="eslint-results" v-if="!!RankMessages.length">
            <div slot="title" style="overflow: hidden;">
                <span style="float: left;">EslintÊä•Âëä</span>
                <span style="float: left; margin-left: 50px;">
                    <span style="margin-right: : 10px;">ÊéíÂ∫è:</span>
                    <mtd-radio-group v-model="sortModel" @change="handleChangeSort" size="small">
                        <mtd-radio-button :value="1">ÈîôËØØÊï∞</mtd-radio-button>
                        <mtd-radio-button :value="2">Êñá‰ª∂Ë∑ØÂæÑ</mtd-radio-button>
                    </mtd-radio-group>
                </span>
                <mtd-button @click="handleOpenCloseAll(openAll)" type="primary" size="small" style="float: right;">
                    {{ openAll ? 'ÂÖ®ÈÉ®ÊäòÂè†' : 'ÂÖ®ÈÉ®Â±ïÂºÄ' }}
                </mtd-button>
            </div>
            <mtd-card
                :class="[
                    'box-card',
                    item.close ? 'close' : 'open',
                    {
                        'is-error': item.errorCount,
                        'is-warning': item.errorCount === 0 && item.warningCount,
                        'is-success': item.errorCount + item.warningCount === 0
                    }
                ]"
                :body-style="{ padding: 0 }"
                shadow="never"
                v-for="(item, index) in tableData"
                :key="index"
            >
                <div slot="title" @click="() => handleOpenItem(index)">
                    <mtd-icon name="check"></mtd-icon>
                    <mtd-icon name="right"></mtd-icon>
                    <mtd-icon name="down"></mtd-icon>
                    <span class="filePath" @click.stop>{{ item.filePath }}</span>
                    <mtd-tooltip content="Â§çÂà∂Êñá‰ª∂Ë∑ØÂæÑ" placement="top">
                        <mtd-icon name="copy-o" @click.stop="handleCopyFilePath(item)" />
                    </mtd-tooltip>
                    <b class="error-warning-count" style="font-size: 12px;">
                        <span>{{ item.errorCount + item.warningCount }} problems</span>
                        <span v-if="item.errorCount + item.warningCount !== 0">
                            <span>(</span>
                            <span>{{ item.errorCount }} errors,</span>
                            <span>{{ item.warningCount }} warnings,</span>
                            <span>{{ item.fixableErrorCount + item.fixableWarningCount }} fixable</span>
                            <span>)</span>
                        </span>
                    </b>
                </div>
                <mtd-table
                    v-show="item.messages.length"
                    :data="item.messages"
                    :show-header="false"
                    style="width: 100%"
                    size="small"
                    :max-height="41 * 100"
                >
                    <mtd-table-column width="70">
                        <template slot-scope="scope">
                            {{ [scope.row.line, scope.row.column].join(':') }}
                        </template>
                    </mtd-table-column>
                    <mtd-table-column width="90">
                        <template slot-scope="scope">
                            <span v-if="scope.row.severity === 1" class="color-warning">Warning</span>
                            <span v-if="scope.row.severity === 2" class="color-danger">Error</span>
                        </template>
                    </mtd-table-column>
                    <mtd-table-column>
                        <template slot-scope="scope">
                            <pre style="margin: 0;">{{ scope.row.message }}</pre>
                        </template>
                    </mtd-table-column>
                    <mtd-table-column width="210" align="right">
                        <template slot-scope="scope" v-if="scope.row.ruleId">
                            <a :href="scope.row.url" target="_blank">
                                <mtd-button type="text-primary" size="small">{{ scope.row.ruleId }}</mtd-button>
                            </a>
                        </template>
                    </mtd-table-column>
                </mtd-table>
            </mtd-card>
        </mtd-card>
    </div>

        <script src="https://static.meituan.net/bs/vue/2.6.11/dist/vue.js"></script>
        <script src="https://static.meituan.net/bs/@ss/mtd-vue/0.3.5/lib/index.js"></script>
        <script src="https://static.meituan.net/bs/lodash/4.17.15/lodash.min.js"></script>
        <script src="EslintResults.js"></script>
        <script src="RulesMeta.js"></script>
        <script src="../lib/script.js"></script>
    </body>
</html>
